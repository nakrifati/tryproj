<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>OpenVPN User Web Administration Panel</title>

  <!-- Custom fonts for this template-->
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static "style.css" %}">
</head>
<body id="page-top">

    <div class="container">
    <h1 class="h2 text-gray-900 mb-4 text-center">OpenVPN User Web Administration Panel</h1>

<p></p>

        <div style="display:inline-block; vertical-align: middle;">
        <form class="form-inline" action="{% url 'home' %}">
            <button type="submit" class="btn btn-primary">Home</button>
        </form>
        </div>
<p></p>
        <form class="form-inline" action="{% url 'admin:index' %}">
            <button type="submit" class="btn btn-danger">Admin Panel</button>
        </form>


        <p></p>
    <h4 class="h4 text-gray-900 mb-4">Add New User</h4>

<form action='{% url 'create_ovpn_user' %}' method='POST'>{% csrf_token %}
    <input type="text" name="username" class="form-control" placeholder="Username" />
    <p></p>
    <input type="text" name="out_ip" class="form-control" placeholder="Outgoing IP" />
    <p></p>
    <button type='submit' class="btn btn-success">Add User to OpenVPN</button>
</form>

        <p></p>

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

    <p></p>

        <h1 class="h3 text-gray-900 mb-4">Online OpenVPN Users</h1>

    <table class="table table-bordered">

    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Real Address</th>
            <th scope="col">V.Address</th>
            <th scope="col">Connected Since</th>
        </tr>
    </thead>

{% for element in users_online %}
<tbody>
    <tr>

        <td>{{ element }}</td>
        <td>{{ rule.table }}</td>
        <td>{{ rule.ipv }}</td>
        <td>{{ rule.chain }}</td>
    </tr>
</tbody>
{% endfor %}
</table>


    <p>Total Online: {{ total_online }}</p>
    <p></p>

    <h1 class="h3 text-gray-900 mb-4">List of OpenVPN Users</h1>

<table class="table table-bordered">

    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">IP</th>
        </tr>
    </thead>
{% for Ouser in allouser %}

<tbody>
    <tr>
        <td>{{ Ouser.name }}</td>
        <td>{{ Ouser.ip }}</td>
    </tr>
</tbody>
{% endfor %}
</table>

        <form action='{% url 'list_ovpn_user' %}' method='POST'>{% csrf_token %}
            <p></p>
            <button type='submit' class="btn btn-primary">Load OpenVPN Users from server</button>
        </form>

    <div class="footer-copyright text-center py-3">Made by Alexey Beleychev
    <a href="mailto:a.beleichev@abr-region.ru">a.beleichev@abr-region.ru</a>
</div>

    </div>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

</body>
</html>